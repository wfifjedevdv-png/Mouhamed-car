<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mouhamed Motors</title>

<style>
body{
  margin:0;
  background:#000;
  color:white;
  font-family:Segoe UI,Tahoma;
}

/* LOGIN */
#login{
 display:flex;
 justify-content:center;
 align-items:center;
 height:100vh;
}

.login-box{
 background:rgba(255,255,255,.08);
 padding:32px;
 width:340px;
 border-radius:24px;
 text-align:center;
}

.login-box.admin{
 border:1px solid rgba(58,160,255,.35);
 box-shadow:0 0 35px rgba(58,160,255,.25);
}

input{
 width:100%;
 padding:13px 14px;
 margin-top:14px;
 border-radius:14px;
 border:1px solid rgba(255,255,255,.08);
 background:#020617;
 color:white;
 font-size:15px;
}

button{
 width:100%;
 padding:13px;
 margin-top:18px;
 border:none;
 border-radius:14px;
 background:linear-gradient(135deg,#1e90ff,#3aa0ff);
 color:white;
 font-size:16px;
 cursor:pointer;
}

.link{
 margin-top:14px;
 color:#3aa0ff;
 cursor:pointer;
 font-size:14px;
}

#error{
 color:#ff6b6b;
 margin-top:12px;
 display:none;
}

/* NAV */
nav{
 display:none;
 justify-content:space-between;
 align-items:center;
 padding:15px 20px;
 background:#020617;
 position:relative;
}

.cart-btn{
 cursor:pointer;
 font-size:22px;
 position:relative;
}

#cartCount{
 position:absolute;
 top:-6px;
 left:-8px;
 background:red;
 color:white;
 font-size:12px;
 padding:2px 6px;
 border-radius:999px;
}

/* CART PANEL */
#cartPanel{
 position:fixed;
 top:70px;
 left:16px;
 width:300px;
 background:#020617;
 border-radius:18px;
 padding:14px;
 display:none;
 z-index:999;
 box-shadow:0 0 30px rgba(0,0,0,.6);
}

#cartPanel h4{
 margin:0 0 10px;
}

/* CONTENT */
#content{
 display:none;
 padding:20px;
 max-width:1200px;
 margin:auto;
}

.search{
 margin-bottom:20px;
 width:100%;
 padding:12px;
 border-radius:14px;
 border:none;
 background:#111827;
 color:white;
}

.cars{
 display:grid;
 grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
 gap:20px;
}

.car{
 background:rgba(255,255,255,.08);
 border-radius:20px;
 overflow:hidden;
 cursor:pointer;
 transition:.3s;
}

.car:hover{ transform:translateY(-5px); }

.car img{
 width:100%;
 height:180px;
 object-fit:cover;
}

.car .info{ padding:15px; }
.price{ color:#3aa0ff; font-weight:bold; }
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
 <div class="login-box" id="loginBox">
  <h2 id="formTitle">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>

  <input id="name" placeholder="Ø§Ø³Ù…Ùƒ" style="display:none">
  <input id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
  <input id="password" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">

  <button onclick="submitForm()">Ø¯Ø®ÙˆÙ„</button>

  <div class="link" onclick="toggleForm()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</div>
  <div id="error"></div>
 </div>
</div>

<!-- NAV -->
<nav id="nav">
 <h3>ğŸš— Mouhamed Motors</h3>

 <div style="display:flex;gap:16px;align-items:center">
  <div class="cart-btn" onclick="toggleCart()">ğŸ›’
   <span id="cartCount">0</span>
  </div>
  <button onclick="logout()" style="width:auto;padding:8px 16px">Ø®Ø±ÙˆØ¬</button>
 </div>
</nav>

<!-- CART -->
<div id="cartPanel">
 <h4>ğŸ›’ Ø¹Ø±Ø¨Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h4>
 <div id="cartList"></div>
</div>

<!-- CONTENT -->
<div id="content">
 <input class="search" id="search" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø³ÙŠØ§Ø±Ø©" oninput="renderCars()">
 <div class="cars" id="cars"></div>
</div>

<script>
/* Ø£Ø¯Ù…Ù† */
const ADMIN_USER = "mouhamed";
const ADMIN_PASS = "Lm2007tt";

/* Ø¹Ù†Ø§ØµØ± */
const loginBox = document.getElementById("login");
const nav = document.getElementById("nav");
const content = document.getElementById("content");
const error = document.getElementById("error");

const nameInput = document.getElementById("name");
const emailInput = document.getElementById("email");
const passInput = document.getElementById("password");
const formTitle = document.getElementById("formTitle");

let isRegister = false;

/* Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† */
let users = JSON.parse(localStorage.getItem("users") || "[]");

/* ØªØ¨Ø¯ÙŠÙ„ */
function toggleForm(){
 isRegister = !isRegister;
 formTitle.innerText = isRegister ? "ğŸ†• Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨" : "ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
 nameInput.style.display = isRegister ? "block" : "none";
 error.style.display="none";
}

/* Ø¥Ø±Ø³Ø§Ù„ */
function submitForm(){
 const email = emailInput.value.trim();
 const pass = passInput.value.trim();
 const name = nameInput.value.trim();

 if(!email || !pass || (isRegister && !name)){
  showError("Ø£ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
  return;
 }

 if(!isRegister && email===ADMIN_USER && pass===ADMIN_PASS){
  localStorage.setItem("session", JSON.stringify({role:"admin"}));
  location.href="admin.html";
  return;
 }

 if(isRegister){
  if(users.find(u=>u.email===email)){
   showError("Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…");
   return;
  }
  users.push({name,email,password:pass,role:"user"});
  localStorage.setItem("users",JSON.stringify(users));
 }

 const user = users.find(u=>u.email===email && u.password===pass);
 if(!user){
  showError("Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
  return;
 }

 localStorage.setItem("session", JSON.stringify(user));
 start();
}

/* Ø¨Ø¯Ø¡ */
function start(){
 const session = JSON.parse(localStorage.getItem("session"));
 if(!session) return;

 loginBox.style.display="none";
 nav.style.display="flex";
 content.style.display="block";
 renderCars();
 renderCart();
}

/* Ø®Ø±ÙˆØ¬ */
function logout(){
 localStorage.removeItem("session");
 location.reload();
}

/* Ø³ÙŠØ§Ø±Ø§Øª */
function renderCars(){
 const q = document.getElementById("search").value.toLowerCase();
 const box = document.getElementById("cars");
 const cars = JSON.parse(localStorage.getItem("cars") || "[]");

 box.innerHTML="";

 if(!cars.length){
  box.innerHTML="<p style='opacity:.6'>ğŸš— Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³ÙŠØ§Ø±Ø§Øª Ø¨Ø¹Ø¯</p>";
  return;
 }

 cars.filter(c=>c.name.toLowerCase().includes(q))
 .forEach((c,i)=>{
  box.innerHTML+=`
   <div class="car" onclick="openCar(${i})">
    <img src="${c.img}">
    <div class="info">
     <h4>${c.name}</h4>
     <p>${c.desc || ""}</p>
     <div class="price">${c.price}</div>
    </div>
   </div>`;
 });
}

/* ÙØªØ­ Ø³ÙŠØ§Ø±Ø© */
function openCar(i){
 localStorage.setItem("currentCar",i);
 location.href="car.html";
}

/* ====== CART ====== */
function cartKey(){
 const s = JSON.parse(localStorage.getItem("session"));
 return "cart_" + s.email;
}

function toggleCart(){
 const p = document.getElementById("cartPanel");
 p.style.display = p.style.display==="block" ? "none" : "block";
 renderCart();
}

function renderCart(){
 const list = document.getElementById("cartList");
 const cart = JSON.parse(localStorage.getItem(cartKey()) || "[]");

 document.getElementById("cartCount").innerText = cart.length;
 list.innerHTML="";

 if(!cart.length){
  list.innerHTML="<p style='opacity:.6'>Ø§Ù„Ø¹Ø±Ø¨Ø© ÙØ§Ø±ØºØ©</p>";
  return;
 }

 cart.forEach(c=>{
  list.innerHTML+=`
   <div style="display:flex;gap:10px;margin-bottom:10px">
    <img src="${c.img}" style="width:60px;border-radius:10px">
    <div>
     <div>${c.name}</div>
     <div style="color:#3aa0ff">${c.price}</div>
    </div>
   </div>`;
 });
}

function showError(t){
 error.innerText=t;
 error.style.display="block";
}

start();
</script>

</body>
</html>
